var c=function(){return c=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},c.apply(this,arguments)},k={autoplayFirstVideo:!0,youTubePlayerParams:!1,vimeoPlayerParams:!1,wistiaPlayerParams:!1,gotoNextSlideOnVideoEnd:!0,autoplayVideoOnSlide:!1,videojs:!1,videojsTheme:"",videojsOptions:{}},f={afterAppendSlide:"lgAfterAppendSlide",init:"lgInit",hasVideo:"lgHasVideo",containerResize:"lgContainerResize",updateSlides:"lgUpdateSlides",afterAppendSubHtml:"lgAfterAppendSubHtml",beforeOpen:"lgBeforeOpen",afterOpen:"lgAfterOpen",slideItemLoad:"lgSlideItemLoad",beforeSlide:"lgBeforeSlide",afterSlide:"lgAfterSlide",posterClick:"lgPosterClick",dragStart:"lgDragStart",dragMove:"lgDragMove",dragEnd:"lgDragEnd",beforeNextSlide:"lgBeforeNextSlide",beforePrevSlide:"lgBeforePrevSlide",beforeClose:"lgBeforeClose",afterClose:"lgAfterClose",rotateLeft:"lgRotateLeft",rotateRight:"lgRotateRight",flipHorizontal:"lgFlipHorizontal",flipVertical:"lgFlipVertical",autoplay:"lgAutoplay",autoplayStart:"lgAutoplayStart",autoplayStop:"lgAutoplayStop"},y=function(s){return Object.keys(s).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(s[e])}).join("&")},C=function(s){var e=s.slice(1).split("&").map(function(t){return t.split("=")}).reduce(function(t,i){var r=i.map(decodeURIComponent),o=r[0],a=r[1];return t[o]=a,t},{});return e},_=function(s,e){if(!s.youtube)return"";var t=s.youtube[2]?C(s.youtube[2]):"",i={wmode:"opaque",autoplay:0,mute:1,enablejsapi:1},r=e||{},o=c(c(c({},i),r),t),a="?"+y(o);return a},A=function(s){return s.includes("youtube-nocookie.com")},L=function(s,e){if(!e||!e.vimeo)return"";var t=e.vimeo[2]||"",i=s&&Object.keys(s).length!==0?"&"+y(s):"",r=e.vimeo[0].split("/").pop()||"",o=r.split("?")[0]||"",a=o.split("#")[0],n=e.vimeo[1]!==a;n&&(t=t.replace("/"+a,"")),t=t[0]=="?"?"&"+t.slice(1):t||"";var l="?autoplay=0&muted=1"+(n?"&h="+a:"")+i+t;return l},T=function(){function s(e){return this.core=e,this.settings=c(c({},k),this.core.settings),this}return s.prototype.init=function(){var e=this;this.core.LGel.on(f.hasVideo+".video",this.onHasVideo.bind(this)),this.core.LGel.on(f.posterClick+".video",function(){var t=e.core.getSlideItem(e.core.index);e.loadVideoOnPosterClick(t)}),this.core.LGel.on(f.slideItemLoad+".video",this.onSlideItemLoad.bind(this)),this.core.LGel.on(f.beforeSlide+".video",this.onBeforeSlide.bind(this)),this.core.LGel.on(f.afterSlide+".video",this.onAfterSlide.bind(this))},s.prototype.onSlideItemLoad=function(e){var t=this,i=e.detail,r=i.isFirstSlide,o=i.index;this.settings.autoplayFirstVideo&&r&&o===this.core.index&&setTimeout(function(){t.loadAndPlayVideo(o)},200),!r&&this.settings.autoplayVideoOnSlide&&o===this.core.index&&this.loadAndPlayVideo(o)},s.prototype.onHasVideo=function(e){var t=e.detail,i=t.index,r=t.src,o=t.html5Video,a=t.hasPoster;a||(this.appendVideos(this.core.getSlideItem(i),{src:r,addClass:"lg-object",index:i,html5Video:o}),this.gotoNextSlideOnVideoEnd(r,i))},s.prototype.onBeforeSlide=function(e){if(this.core.lGalleryOn){var t=e.detail.prevIndex;this.pauseVideo(t)}},s.prototype.onAfterSlide=function(e){var t=this,i=e.detail,r=i.index,o=i.prevIndex,a=this.core.getSlideItem(r);this.settings.autoplayVideoOnSlide&&r!==o&&a.hasClass("lg-complete")&&setTimeout(function(){t.loadAndPlayVideo(r)},100)},s.prototype.loadAndPlayVideo=function(e){var t=this.core.getSlideItem(e),i=this.core.galleryItems[e];i.poster?this.loadVideoOnPosterClick(t,!0):this.playVideo(e)},s.prototype.playVideo=function(e){this.controlVideo(e,"play")},s.prototype.pauseVideo=function(e){this.controlVideo(e,"pause")},s.prototype.getVideoHtml=function(e,t,i,r){var o="",a=this.core.galleryItems[i].__slideVideoInfo||{},n=this.core.galleryItems[i],l=n.title||n.alt;l=l?'title="'+l+'"':"";var g=`allowtransparency="true"
            frameborder="0"
            scrolling="no"
            allowfullscreen
            mozallowfullscreen
            webkitallowfullscreen
            oallowfullscreen
            msallowfullscreen`;if(a.youtube){var h="lg-youtube"+i,P=_(a,this.settings.youTubePlayerParams),j=A(e),I=j?"//www.youtube-nocookie.com/":"//www.youtube.com/";o='<iframe allow="autoplay" id='+h+' class="lg-video-object lg-youtube '+t+'" '+l+' src="'+I+"embed/"+(a.youtube[1]+P)+'" '+g+"></iframe>"}else if(a.vimeo){var h="lg-vimeo"+i,u=L(this.settings.vimeoPlayerParams,a);o='<iframe allow="autoplay" id='+h+' class="lg-video-object lg-vimeo '+t+'" '+l+' src="//player.vimeo.com/video/'+(a.vimeo[1]+u)+'" '+g+"></iframe>"}else if(a.wistia){var x="lg-wistia"+i,u=y(this.settings.wistiaPlayerParams);u=u?"?"+u:"",o='<iframe allow="autoplay" id="'+x+'" src="//fast.wistia.net/embed/iframe/'+(a.wistia[4]+u)+'" '+l+' class="wistia_embed lg-video-object lg-wistia '+t+'" name="wistia_embed" '+g+"></iframe>"}else if(a.html5){for(var p="",d=0;d<r.source.length;d++)p+='<source src="'+r.source[d].src+'" type="'+r.source[d].type+'">';if(r.tracks)for(var O=function(v){var w="",S=r.tracks[v];Object.keys(S||{}).forEach(function(V){w+=V+'="'+S[V]+'" '}),p+="<track "+w+">"},d=0;d<r.tracks.length;d++)O(d);var m="",b=r.attributes||{};Object.keys(b||{}).forEach(function(v){m+=v+'="'+b[v]+'" '}),o='<video class="lg-video-object lg-html5 '+(this.settings.videojs&&this.settings.videojsTheme?this.settings.videojsTheme+" ":"")+" "+(this.settings.videojs?" video-js":"")+'" '+m+`>
                `+p+`
                Your browser does not support HTML5 video.
            </video>`}return o},s.prototype.appendVideos=function(e,t){var i,r=this.getVideoHtml(t.src,t.addClass,t.index,t.html5Video);e.find(".lg-video-cont").append(r);var o=e.find(".lg-video-object").first();if(t.html5Video&&o.on("mousedown.lg.video",function(a){a.stopPropagation()}),this.settings.videojs&&(!((i=this.core.galleryItems[t.index].__slideVideoInfo)===null||i===void 0)&&i.html5))try{return videojs(o.get(),this.settings.videojsOptions)}catch{console.error("lightGallery:- Make sure you have included videojs")}},s.prototype.gotoNextSlideOnVideoEnd=function(e,t){var i=this,r=this.core.getSlideItem(t).find(".lg-video-object").first(),o=this.core.galleryItems[t].__slideVideoInfo||{};if(this.settings.gotoNextSlideOnVideoEnd){if(o.html5)r.on("ended",function(){i.core.goToNextSlide()});else if(o.vimeo)try{new Vimeo.Player(r.get()).on("ended",function(){i.core.goToNextSlide()})}catch{console.error("lightGallery:- Make sure you have included //github.com/vimeo/player.js")}else if(o.wistia)try{window._wq=window._wq||[],window._wq.push({id:r.attr("id"),onReady:function(a){a.bind("end",function(){i.core.goToNextSlide()})}})}catch{console.error("lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js")}}},s.prototype.controlVideo=function(e,t){var i=this.core.getSlideItem(e).find(".lg-video-object").first(),r=this.core.galleryItems[e].__slideVideoInfo||{};if(i.get()){if(r.youtube)try{i.get().contentWindow.postMessage('{"event":"command","func":"'+t+'Video","args":""}',"*")}catch(o){console.error("lightGallery:- "+o)}else if(r.vimeo)try{new Vimeo.Player(i.get())[t]()}catch{console.error("lightGallery:- Make sure you have included //github.com/vimeo/player.js")}else if(r.html5)if(this.settings.videojs)try{videojs(i.get())[t]()}catch{console.error("lightGallery:- Make sure you have included videojs")}else i.get()[t]();else if(r.wistia)try{window._wq=window._wq||[],window._wq.push({id:i.attr("id"),onReady:function(o){o[t]()}})}catch{console.error("lightGallery:- Make sure you have included //fast.wistia.com/assets/external/E-v1.js")}}},s.prototype.loadVideoOnPosterClick=function(e,t){var i=this;if(e.hasClass("lg-video-loaded"))t&&this.playVideo(this.core.index);else if(e.hasClass("lg-has-video"))this.playVideo(this.core.index);else{e.addClass("lg-has-video");var r=void 0,o=this.core.galleryItems[this.core.index].src,a=this.core.galleryItems[this.core.index].video;a&&(r=typeof a=="string"?JSON.parse(a):a);var n=this.appendVideos(e,{src:o,addClass:"",index:this.core.index,html5Video:r});this.gotoNextSlideOnVideoEnd(o,this.core.index);var l=e.find(".lg-object").first().get();e.find(".lg-video-cont").first().append(l),e.addClass("lg-video-loading"),n&&n.ready(function(){n.on("loadedmetadata",function(){i.onVideoLoadAfterPosterClick(e,i.core.index)})}),e.find(".lg-video-object").first().on("load.lg error.lg loadedmetadata.lg",function(){setTimeout(function(){i.onVideoLoadAfterPosterClick(e,i.core.index)},50)})}},s.prototype.onVideoLoadAfterPosterClick=function(e,t){e.addClass("lg-video-loaded"),this.playVideo(t)},s.prototype.destroy=function(){this.core.LGel.off(".lg.video"),this.core.LGel.off(".video")},s}(),G=T;export{G as a};
